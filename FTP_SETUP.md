# Настройка FTP для автоматической загрузки файлов

## Описание

Проект настроен для автоматической загрузки собранных файлов из папки `dist` на FTP-сервер при сборке в режиме продакшена.

## Настройка

### 1. Откройте файл `template.config.js`

Найдите секцию `ftp` и настройте параметры подключения:

```javascript
ftp: {
    // Адрес FTP сервера
    host: 'your-ftp-server.com',
    // Порт FTP сервера (обычно 21)
    port: 21,
    // Удаленная директория на сервере (куда загружать файлы)
    remoteDir: '/www/your-site/public_html',
    // Имя пользователя FTP
    user: 'your-username',
    // Пароль FTP
    password: 'your-password',
    // Локальная директория для загрузки (по умолчанию 'dist')
    // localRoot: 'dist',
    // Массив файлов/паттернов для включения (опционально)
    // include: ['*', '**/*'],
    // Время ожидания подключения в миллисекундах (опционально, по умолчанию 10000)
    // waitingTime: 10000,
},
```

### 2. Параметры конфигурации

- **`host`** (обязательно) - Адрес FTP сервера (например: `ftp.example.com` или IP-адрес)
- **`port`** (обязательно) - Порт FTP сервера (обычно `21`, для SFTP может быть `22`)
- **`remoteDir`** (обязательно) - Путь к директории на сервере, куда будут загружены файлы (например: `/www/your-site/public_html` или `/public_html`)
- **`user`** (обязательно) - Имя пользователя для подключения к FTP
- **`password`** (обязательно) - Пароль для подключения к FTP
- **`localRoot`** (опционально) - Локальная директория для загрузки (по умолчанию `dist`)
- **`include`** (опционально) - Массив паттернов файлов для включения (по умолчанию загружаются все файлы)
- **`waitingTime`** (опционально) - Время ожидания подключения в миллисекундах (по умолчанию `10000`)

### 3. Безопасность

⚠️ **Важно**: Не коммитьте файл `template.config.js` с реальными учетными данными в публичный репозиторий!

#### Использование переменных окружения (рекомендуется)

Конфигурация уже поддерживает переменные окружения. Вы можете создать файл `.env` в корне проекта:

```env
FTP_HOST=your-ftp-server.com
FTP_PORT=21
FTP_REMOTE_DIR=/www/your-site/public_html
FTP_USER=your-username
FTP_PASSWORD=your-secure-password
```

Или установить переменные окружения перед запуском:

**Windows (PowerShell):**
```powershell
$env:FTP_HOST="your-ftp-server.com"
$env:FTP_PORT="21"
$env:FTP_REMOTE_DIR="/www/your-site/public_html"
$env:FTP_USER="your-username"
$env:FTP_PASSWORD="your-secure-password"
npm run deploy
```

**Windows (CMD):**
```cmd
set FTP_HOST=your-ftp-server.com
set FTP_PORT=21
set FTP_REMOTE_DIR=/www/your-site/public_html
set FTP_USER=your-username
set FTP_PASSWORD=your-secure-password
npm run deploy
```

**Linux/Mac:**
```bash
export FTP_HOST="your-ftp-server.com"
export FTP_PORT="21"
export FTP_REMOTE_DIR="/www/your-site/public_html"
export FTP_USER="your-username"
export FTP_PASSWORD="your-secure-password"
npm run deploy
```

⚠️ **Не забудьте добавить `.env` в `.gitignore`!**

#### Альтернативные методы:

- Добавить `template.config.js` в `.gitignore` (если содержит секретные данные)
- Или создать отдельный файл `template.config.local.js` для локальных настроек

## Использование

### Запуск сборки с загрузкой на FTP

После настройки параметров FTP, выполните команду:

```bash
npm run deploy
```

Эта команда:
1. Соберет проект в режиме продакшена (`vite build`)
2. Автоматически загрузит все файлы из папки `dist` на FTP-сервер

### Альтернативная команда

Вы также можете использовать:

```bash
vite build -- --ftp
```

## Процесс работы

1. **Сборка проекта**: Vite собирает проект в папку `dist`
2. **Подключение к FTP**: Плагин подключается к указанному FTP-серверу
3. **Загрузка файлов**: Все файлы из `dist` загружаются в указанную `remoteDir` на сервере
4. **Логирование**: В консоли отображается прогресс загрузки

## Устранение проблем

### Ошибка подключения

- Проверьте правильность адреса сервера (`host`)
- Убедитесь, что порт указан верно (`port`)
- Проверьте, что сервер доступен (может быть заблокирован файрволом)

### Ошибка аутентификации

- Проверьте правильность `user` и `password`
- Убедитесь, что учетная запись активна

### Ошибка доступа к директории

- Проверьте правильность пути `remoteDir`
- Убедитесь, что у пользователя есть права на запись в эту директорию

### Файлы не загружаются

- Проверьте, что папка `dist` существует и содержит файлы
- Убедитесь, что сборка прошла успешно
- Проверьте параметр `include`, если он указан

## Дополнительная информация

Плагин использует `vite-plugin-ftp`, который основан на `ftp-deploy`.

Документация плагина: https://github.com/JianGuoPaPa/vite-plugin-ftp
